<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>IPv6 Voucher-Based Addressing During SLAAC</title>
<meta content="Zack Puhl" name="author">
<meta content="Jeremy Duncan" name="author">
<meta content='
       
        Voucher-Based Addressing updates the SLAAC process (RFC4862) with a new, extensible IPv6
        address generation and verification methodology. A "voucher" is distributed to nodes on
        a local link to provide local-scope generation instructions. Nodes use these instructions,
        their own link-layer identifiers, and self-determined work factor values to create
        sets of pseudo-random, deterministic addresses for each on-link prefix. This process
        is driven by cryptographic key derivation functions which intentionally lengthen
        address computation times. Each output address is bound to its inputs by hashing, with
        binding details being verifiable by neighbors while simultaneously appearing random
        to off-link parties.
       
    ' name="description">
<meta content="xml2rfc 3.23.1" name="generator">
<meta content="ipv6" name="keyword">
<meta content="slaac" name="keyword">
<meta content="privacy" name="keyword">
<meta content="vba" name="keyword">
<meta content="draft-puhl-6man-vba-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.23.1
    Python 3.10.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.3.3
    pycountry 24.6.1
    pydyf 0.9.0
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 59.6.0
    wcwidth 0.2.13
    weasyprint 61.2
-->
<link href="/usr/src/app/tmp/44a933e4-a2b7-43ac-ba65-7b85538443ce/draft-puhl-6man-vba-00.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<link rel="describedBy" href="https://doi.org/10.3390/network4030016">
  <script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">vba</td>
<td class="right">September 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Puhl &amp; Duncan</td>
<td class="center">Expires 28 March 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">IPv6 Maintenance</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-puhl-6man-vba-00</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc4862" class="eref">4862</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-09-24" class="published">24 September 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-03-28">28 March 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">Z. Puhl</div>
<div class="org">University of Michigan</div>
</div>
<div class="author">
      <div class="author-name">J. Duncan</div>
<div class="org">Tachyon Dynamics</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">IPv6 Voucher-Based Addressing During SLAAC</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
        Voucher-Based Addressing updates the SLAAC process (RFC4862) with a new, extensible IPv6
        address generation and verification methodology. A "voucher" is distributed to nodes on
        a local link to provide local-scope generation instructions. Nodes use these instructions,
        their own link-layer identifiers, and self-determined work factor values to create
        sets of pseudo-random, deterministic addresses for each on-link prefix. This process
        is driven by cryptographic key derivation functions which intentionally lengthen
        address computation times. Each output address is bound to its inputs by hashing, with
        binding details being verifiable by neighbors while simultaneously appearing random
        to off-link parties.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 March 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-specification-of-requiremen" class="internal xref">Specification of Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-background" class="internal xref">Background</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-voucher-based-addressing" class="internal xref">Voucher-Based Addressing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-design" class="internal xref">Design</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-link-layer-address-bindings" class="internal xref">Link-Layer Address Bindings</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-hash-function-selection-eph" class="internal xref">Hash Function Selection &amp; Ephemeral Addressing</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-address-generation" class="internal xref">Address Generation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-address-verification" class="internal xref">Address Verification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-preserving-link-voucher-sta" class="internal xref">Preserving Link Voucher State</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-link-voucher-acquisitions" class="internal xref">Link Voucher Acquisitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-link-voucher-transitions" class="internal xref">Link Voucher Transitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-duplicate-address-detection" class="internal xref">Duplicate Address Detection</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-the-link-voucher-option" class="internal xref">The Link Voucher Option</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-processing-rules-for-sender" class="internal xref">Processing Rules for Senders</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-processing-rules-for-receiv" class="internal xref">Processing Rules for Receivers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-the-algorithm-type-field" class="internal xref">The Algorithm Type Field</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-local-on-link-voucher-multi" class="internal xref">Local On-link Voucher Multicast Address</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-constraints" class="internal xref">Constraints</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-message-types" class="internal xref">Message Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-voucher-capability-indicati" class="internal xref">Voucher Capability Indications (VCIs)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-voucher-handoff-advertiseme" class="internal xref">Voucher Handoff Advertisements (VHAs)</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-collision-resistance-time-m" class="internal xref">Collision Resistance &amp; Time-Memory Tradeoffs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-employing-ra-guard" class="internal xref">Employing RA-Guard</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-hijacking-or-desynchronizin" class="internal xref">Hijacking or Desynchronizing Link Vouchers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-voucher-rotation-intervals" class="internal xref">Voucher Rotation Intervals</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-future-work" class="internal xref">Future Work</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-deployments-using-dhcp" class="internal xref">Deployments using DHCP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-certifying-link-vouchers" class="internal xref">Certifying Link Vouchers</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-code-snippets" class="internal xref">Code Snippets</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
        Voucher-Based Addressing (VBA) offers local IPv6 networks both a common procedure
        for binding Link-Layer Identifers (LLID) to IP addresses, as well as privacy-focused
        IP address autoconfiguration for both stable and ephemeral addresses. The usefulness of
        the former is expressed in Neighbor Discovery Protocol (NDP) transactions, which resolve
        LLIDs corresponding to queried IP addresses. The usefulness of the latter is articulated
        well in specifications like <span>[<a href="#RFC7217" class="cite xref">RFC7217</a>]</span>, <span>[<a href="#RFC7721" class="cite xref">RFC7721</a>]</span>,
        <span>[<a href="#RFC8064" class="cite xref">RFC8064</a>]</span>, and <span>[<a href="#RFC8981" class="cite xref">RFC8981</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
        This document intends to update <span>[<a href="#RFC4862" class="cite xref">RFC4862</a>]</span> to introduce a new address assignment
        methodology. It describes an application of cryptographic key-stretching techniques and
        link-local configuration distribution to the IPv6 SLAAC process (<span>[<a href="#RFC4862" class="cite xref">RFC4862</a>]</span>),
        creating a many-to-one relationship between an interface's IP addresses and its underlying
        LLID. This relationship is created in such a way that only neighbors on the same broadcast
        domain can confirm its validity, and external actors will be unaware of its existence entirely.<a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="intro-requirements">
<section id="section-1.1">
        <h3 id="name-specification-of-requiremen">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-specification-of-requiremen" class="section-name selfRef">Specification of Requirements</a>
        </h3>
<p id="section-1.1-1">
          The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
          "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>",
          "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
          interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span>
          <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in
          all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intro-background">
<section id="section-1.2">
        <h3 id="name-background">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-background" class="section-name selfRef">Background</a>
        </h3>
<p id="section-1.2-1">
          This document assumes the reader's basic familiarity with the following specifications.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-1.2-2.1">IP Version 6 Addressing Architecture <span>[<a href="#RFC4291" class="cite xref">RFC4291</a>]</span>.<a href="#section-1.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.2-2.2">IPv6 Stateless Address Autoconfiguration <span>[<a href="#RFC4862" class="cite xref">RFC4862</a>]</span>.<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.2-2.3">Semantically Opaque Interface Identifiers <span>[<a href="#RFC7217" class="cite xref">RFC7217</a>]</span>.<a href="#section-1.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.2-2.4">Security and Privacy Considerations for IPv6 Address Generation Mechanisms <span>[<a href="#RFC7721" class="cite xref">RFC7721</a>]</span>.<a href="#section-1.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.2-2.5">Recommendation on Stable IPv6 Interface Identifiers <span>[<a href="#RFC8064" class="cite xref">RFC8064</a>]</span>.<a href="#section-1.2-2.5" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.2-2.6">Temporary Address Extensions for Stateless Address Autoconfiguration in IPv6 <span>[<a href="#RFC8981" class="cite xref">RFC8981</a>]</span>.<a href="#section-1.2-2.6" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.2-2.7">PKCS #5: Password-Based Cryptography Specification Version 2.1 <span>[<a href="#RFC8018" class="cite xref">RFC8018</a>]</span> (primarily Sections 3 and 4).<a href="#section-1.2-2.7" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.2-2.8">The Argon2 Key Derivation Function <span>[<a href="#RFC9106" class="cite xref">RFC9106</a>]</span>.<a href="#section-1.2-2.8" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-1.2-2.9">The Scrypt Key Derivation Function <span>[<a href="#RFC7914" class="cite xref">RFC7914</a>]</span>.<a href="#section-1.2-2.9" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="terms">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">
        To acquire necessary context, please see Section 2.1 of <span>[<a href="#RFC4861" class="cite xref">RFC4861</a>]</span> for
        definitions of the following terms used equivalently in this document: neighbor, node,
        interface, link, address, router, host, on-link, off-link, IP, ICMP, packet, and target.<a href="#section-2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2-2">
        <dt id="section-2-2.1">VBA</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.2">Voucher-Based Addressing. The primary address generation and verification concept
          introduced by this document.<a href="#section-2-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.3">LLID</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.4">A shorthand representation for the terms "Link Layer Address" or "Link Layer Identifier".
          Both terms are synonymous and describe any individual link-layer identifier for a
          connected network interface.<a href="#section-2-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.5">SLAAC</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.6">Stateless Address Autoconfiguration <span>[<a href="#RFC4862" class="cite xref">RFC4862</a>]</span>.<a href="#section-2-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.7">ND(P)</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.8">Neighbor Discovery (Protocol) <span>[<a href="#RFC4861" class="cite xref">RFC4861</a>]</span>.<a href="#section-2-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.9">RS, RA, NS, and NA</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.10">Respectively: Router Solicitation, Router Advertisement, Neighbor Soliciation, and
          Neighbor Advertisement. A collection of abbreviations for ICMP packet types defined
          by NDP in <span>[<a href="#RFC4861" class="cite xref">RFC4861</a>]</span>.<a href="#section-2-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.11">DAD</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.12">Duplicate Address Detection (Section 5.4 of <span>[<a href="#RFC4862" class="cite xref">RFC4862</a>]</span>).<a href="#section-2-2.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.13">LV</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.14">Link Voucher. A data payload disseminated at the link-local scope by a Voucher Bearer,
            containing instructions for assigning interface SLAAC addresses.<a href="#section-2-2.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.15">VB</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.16">Voucher Bearer. The on-link node solely responsible for dissemination of Link Vouchers.<a href="#section-2-2.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.17">LOVMA</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.18">Local On-link Voucher Multicast Address. A multicast group used by VBA-capable hosts
          to get non-essential information from neighbors or the current Voucher Bearer.<a href="#section-2-2.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.19">VHA</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.20">Voucher Handoff Advertisement. A type of data payload sent by the VB to the LOVMA,
          signing off on an election process for new LV parameters and/or a new link VB.<a href="#section-2-2.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.21">KDF</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.22">Key Derivation Function, as defined in Section 3 of <span>[<a href="#RFC8018" class="cite xref">RFC8018</a>]</span>.<a href="#section-2-2.22" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.23">Hextet</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.24">A 16-bit aggregation; data that is 16 bits in size.<a href="#section-2-2.24" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.25">RA-Guard</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.26">The Router Advertisement Guard mechanism, as specified in <span>[<a href="#RFC6105" class="cite xref">RFC6105</a>]</span>.<a href="#section-2-2.26" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-3">
        NOTE: Any use of the terms 'IP', 'DHCP', or 'ICMP' in the following sections of this
        document are synonymous with 'IPv6', 'DHCPv6', and 'ICMPv6', respectively. When
        referencing the IPv4-based versions of these protocols, it will be explicitly noted.<a href="#section-2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="summary">
<section id="section-3">
      <h2 id="name-voucher-based-addressing">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-voucher-based-addressing" class="section-name selfRef">Voucher-Based Addressing</a>
      </h2>
<p id="section-3-1">
        This section outlines the design goals of Voucher-Based Addressing. It reviews the primary mechanisms
        driving the proposal and discusses related requirements for its adoption. It includes concrete processes
        and procedures used by VBA-capable network nodes to both verify neighbor bindings and to auto-generate
        their own VBAs.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="summary-overview">
<section id="section-3.1">
        <h3 id="name-design">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-design" class="section-name selfRef">Design</a>
        </h3>
<p id="section-3.1-1">
          A Voucher-Based Address is defined as any unicast IP address derived from a hashed combination of
          known voucher information, a subnet prefix, a work factor selection, and a bound LLID. The address
          derivation process is underpinned by a deterministic procedure parameterized by these values. This
          same derivation procedure is employed independently by neighbors to verify purported address bindings.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="summary-overview-binding">
<section id="section-3.1.1">
          <h4 id="name-link-layer-address-bindings">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-link-layer-address-bindings" class="section-name selfRef">Link-Layer Address Bindings</a>
          </h4>
<p id="section-3.1.1-1">
            Voucher-Based Addresses are generated by using the LLID of the underlying, assigned interface as a
            partial input. VBA assumes that LLIDs must be unique to a single node on the same broadcast domain
            at any given time in order for higher-level protocols to successfully operate. Due to this
            assumption of temporal uniqueness, any node actively occupying an LLID on-link is considered
            the 'owner' of its LLID. Therefore, VBAs can be directly formed and authenticated from this 'identity'.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">
            This new 'identity' becomes instrumental when neighbors must resolve an IP address (or set of them)
            to a valid LLID. For example, during Neighbor Discovery Address Resolution, the goal is to associate
            a Target IP with a corresponding LLID to which frames can be forwarded at the link layer (see Section
            7.2 of <span>[<a href="#RFC4861" class="cite xref">RFC4861</a>]</span>). Because VBAs are bound to (i.e., derived from) an LLID, neighbors
            can directly verify any LLID received during NDP transactions to confirm whether the target IP address
            deterministically descends from it. This becomes a simplistic way to detect address spoofing attacks.<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="summary-overview-cryptography">
<section id="section-3.1.2">
          <h4 id="name-hash-function-selection-eph">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-hash-function-selection-eph" class="section-name selfRef">Hash Function Selection &amp; Ephemeral Addressing</a>
          </h4>
<p id="section-3.1.2-1">
            Binding LLIDs to IPs by using a simple embedding or hashing scheme would suffice if VBA were only
            for binding verification. For example, modified EUI-64 interface identifiers use a long-established
            address derivation methodology that incorporates the LLID of an underlying interface (Section 2.5.1 of
            <span>[<a href="#RFC4291" class="cite xref">RFC4291</a>]</span>). While these may provide LLID bindings, VBA augments this concept to enforce
            a privacy-focused address generation technique, obscuring the node's LLID while also encouraging ephemeral
            addressing. VBA employs hashing during the address generation process to create pseudo-random addresses.
            A hash-based address forbids outside trackers from determining the original LLID of the node and also
            ensures that any input LLID of arbitrary length can be deterministically reduced to an IP address suffix
            that is fixed at 64 bits in length.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">
            A known "voucher" holds certain values that are also used as a component of the hash function's input. VBA
            strikes a careful balance of hiding any voucher information from off-link nodes while ensuring voucher
            visibility to on-link nodes. Off-link actors thus cannot acquire the VBA's bound LLID because they do not
            know the details of the voucher used to generate them, nor can they compute the LLID from the address itself.
            Generated VBAs will always appear to be randomly assigned, with little pattern between selected work factors
            and vouchers.<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
<p id="section-3.1.2-3">
            Because hashing would only produce a one-to-one LLID-to-IP binding, this document elevates the use of
            simple hashing for SLAAC address generation to the use of Key Derivation Functions (KDFs). These beget
            a set of one-to-many LL2IP bindings, since KDFs can accept work factor values specifying how many times
            the pseudo-random function or underlying hash function must be iterated <span>[<a href="#RFC8018" class="cite xref">RFC8018</a>]</span>.
            VBA computes KDFs with various inputs that specifically identify a neighbor's on-link interface, and the
            result of the KDF is planted into its generated VBA(s). Work factor selections are embedded into resultant
            IPs adjacent to KDF outputs, such that the following three components are inherent to any generated VBA:<a href="#section-3.1.2-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.1.2-4.1">The interface's Link-Layer Address (LLID).<a href="#section-3.1.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.1.2-4.2">A portion of the KDF's hash output.<a href="#section-3.1.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.1.2-4.3">The work factor used when computing the KDF hash.<a href="#section-3.1.2-4.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="summary-generate">
<section id="section-3.2">
        <h3 id="name-address-generation">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-address-generation" class="section-name selfRef">Address Generation</a>
        </h3>
<p id="section-3.2-1">
          This section discusses VBA composition and the VBA generation procedure.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span id="name-the-voucher-based-address-g"></span><figure id="figure-1">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-3.2-2.1">
<pre>

Address composition:
          PREFIX    //      SUFFIX (64 bits)
    +------ ~ ------+-------------+---------------------+
    | 64-bit prefix | Z (16 bits) |     H (48 bits)     |
    +------ ~ ------+-------------+---------------------+

  where:
    PREFIX is the 64-bit subnet prefix. If the subnet length is
              shorter than 64 bits, then the rest of the 64-bit
              field MUST be initialized to a pseudo-random value.
    SUFFIX is the first 8 bytes from the result of a Key Derivation
              Function 'K' iterated 'L' times. The leftmost hextet
              is replaced by 'Z'.

Formulas:
    H  =  K(L, Key, Salt)
          |---&gt; K    = A KDF explicitly specified by a voucher.
          |---&gt; L    = A node-selected KDF work factor.
          |---&gt; Key  = The 128-bit voucher seed value.
          `---&gt; Salt = [LLID] || 'v' || 'b' || 'a' || [PREFIX]

                          (where '||' represents concatenation)

    Z  =  ~(L ^ Key[0..1])

    SUFFIX = hextets{ Z, H[2..3], H[4..5], H[6..7] }
                            `--&gt; (using 0-based indexing)

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-the-voucher-based-address-g" class="selfRef">The Voucher-Based Address Generation Procedure</a>
          </figcaption></figure>
<p id="section-3.2-3">
          The VBA SUFFIX embeds two necessary details for its verification:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">
            <p id="section-3.2-4.1.1">
              A 16-bit 'Z' value, calculated as a bitwise complement of the XOR of the 16-bit
              'L' value and the first hextet of the interface's current LV seed. This calculation
              uses an XOR operation to ensure that the same work factor 'L' between different LV
              seeds will be unique. This provides some resistance to tracking if a node chooses
              to consistently use the same work factor value.<a href="#section-3.2-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1.2.1">
                The work factor, or 'L' value, controls how many times the KDF 'K' is iterated
                to produce the resulting hash 'H'. Increasing this value increases the work required
                to generate and verify a VBA, as well as the cost of finding its potential collisions.<a href="#section-3.2-4.1.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.2-4.2">
            48 bits from the resulting hash, or 'H' value, derived from the KDF after 'L' iterations.
            Implementations are <span class="bcp14">REQUIRED</span> to use the FIRST 8 bytes of the hash when
            formulating the SUFFIX value, replacing the hash's first hextet with the 'Z' value.<a href="#section-3.2-4.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="summary-verify">
<section id="section-3.3">
        <h3 id="name-address-verification">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-address-verification" class="section-name selfRef">Address Verification</a>
        </h3>
<p id="section-3.3-1">
          "Verification" of an address can occur whenever a node would like to confirm the
          validity and currency of an IP address according both the current Link Voucher and
          the neighbor's purported LLID. One example of where this process might be useful is
          during the NDP address resolution process, where an LLID is returned by a neighbor
          in an answer to a solicitation of an IP address' link-layer location.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">
          Address verification uses public information to locally
          reconstruct VBA(s) with the address generation algorithm. This known information includes
          any neighbor's IP (VBA), their LLID, and the locally stored voucher. The work factor
          used to compute the address can be extracted from the VBA using all known information,
          explained by the function Z' below. If the locally reconstructed
          VBA does not exactly equal the neighbor's VBA, then the bindings
          between the current LV, the IP address, the purported LLID, and the work factor
          <span class="bcp14">MUST</span> be considered invalid.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.3-3">
          <dt id="section-3.3-3.1"><code>Z'(B, LV) = ~(B[8..9] ^ LV.seed[0..1])</code></dt>
          <dd style="margin-left: 1.5em" id="section-3.3-3.2">Calculates the original work factor 'L' from the given VBA 'B'. The value 'B[8..9]'
            is equal to bytes 9 and 10 (bits 64-79, inclusive) of 'B'. The 'LV' represents the
            locally-stored Link Voucher on the verifying host, and 'seed[0..1]' is the first hextet
            of the LV's seed value.<a href="#section-3.3-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="summary-interfaces-state">
<section id="section-3.4">
        <h3 id="name-preserving-link-voucher-sta">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-preserving-link-voucher-sta" class="section-name selfRef">Preserving Link Voucher State</a>
        </h3>
<p id="section-3.4-1">
          VBA-capable interfaces are <span class="bcp14">REQUIRED</span> to store the full state of the
          most current, validated Link Voucher whenever one's presence is detected. This <span class="bcp14">MUST</span>
          occur even if the node does not intend to use VBA address generation or verification.
          If no LV is available, then no stored LV state is maintained and the node <span class="bcp14">MUST</span>
          fall back to another temporary method to generate its IP addresses. Once an LV subsequently
          becomes available, the node <span class="bcp14">MAY</span> elect to generate VBAs on its interface, but
          it <span class="bcp14">MUST</span> track the voucher's state regardless.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">
          LV details <span class="bcp14">MAY</span> also be set statically on an interface. In such cases, the static
          information <span class="bcp14">MUST</span> contain at least a VoucherID, Voucher Seed, and Algorithm Type
          specification. Any interface with static details configured <span class="bcp14">MAY</span> ignore received
          LVs. Static LVs <span class="bcp14">MUST</span> always be considered active and preferred; they <span class="bcp14">MUST NOT</span> expire.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="summary-interfaces-acquisitions">
<section id="section-3.5">
        <h3 id="name-link-voucher-acquisitions">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-link-voucher-acquisitions" class="section-name selfRef">Link Voucher Acquisitions</a>
        </h3>
<p id="section-3.5-1">
          Link Vouchers are <span class="bcp14">REQUIRED</span> to be attached to all RA and Redirect messages by VBs.
          Nodes connecting to the link for the first time are <span class="bcp14">REQUIRED</span> to accept and
          cache the first LV received. If the connecting node intends to maintain responsibility for
          the LV as a VB, then it <span class="bcp14">MUST</span> follow the requirements and processes outlined in
          <a href="#addenda-voucher-senders" class="auto internal xref">Section 4.1</a>. The current LV can be discovered by sending a plain
          Router Solicitation message, or waiting for a Router Advertisement, per normative SLAAC procedures.
          Nodes receiving multiple valid LVs simultaneously <span class="bcp14">SHOULD</span> use the LV with the most
          recent Timestamp value.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">
          An active LV expires when no updated LV with the same 'VoucherID' has been received within the
          amount of seconds specified in the voucher's 'Expiration' field. When an expiration occurs, the
          node <span class="bcp14">MUST</span> again accept the first received LV. The 'Expiration' time can also elapse
          for an interface while it is disconnected from the link. If such an expiration occurs, then that
          interface <span class="bcp14">MUST</span> follow the same LV acquisition process.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">
          Because LV distribution to interfaces requires automatic trust of the VB, it is essential for
          more adversarial networks to implement some form of protection against distribution of unauthorized
          LVs at a lower or intermediate level. See <a href="#security-ra-guard" class="auto internal xref">Section 6.2</a> for more information.
          In the cases where these protective measures are not available, administrators <span class="bcp14">MAY</span>
          choose to set LV information on each node statically and <span class="bcp14">MAY</span> wish to enable some
          variant of intrusion detection.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="summary-interfaces-transitions">
<section id="section-3.6">
        <h3 id="name-link-voucher-transitions">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-link-voucher-transitions" class="section-name selfRef">Link Voucher Transitions</a>
        </h3>
<p id="section-3.6-1">
          The current Voucher Bearer <span class="bcp14">MAY</span> at any time redelegate its responsibility to another
          node (see <a href="#lovma-packets-vha" class="auto internal xref">Section 5.2.2</a>). During the period of transition between the previous
          LV and the new one, VBA-capable nodes which are subscribed to the LOVMA channel <span class="bcp14">SHOULD</span>
          receive VHA multicast packets specifying the parameters of the new LV and VB. These LOVMA-connected
          interfaces are strongly <span class="bcp14">RECOMMENDED</span> to allow both LVs to be cached, so that VBAs
          generated using either LV are verifiable. These interfaces are also strongly <span class="bcp14">RECOMMENDED</span>
          to begin VBA generation with the new LV's parameters ahead of time.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">
          Link Voucher transitions <span class="bcp14">MAY</span> also be used in the case of the VB modifying the
          requirements for VBA generation, such as the Algorithm Type options or the voucher's seed value.<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<span id="name-link-voucher-transitions-2"></span><figure id="figure-2">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-3.6-3.1">
<pre>

  ==========================================&gt; Time
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~+
  ...   LV_A Validity        |
  ~~~|~~~~~|~~~~~X~~~~~~~~~~~Z
     |     |     +~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     |     |     |      LV_B Validity       ...
     |     |     +~~~~~|~~~~~|~~~~~|~~~~~|~~~~~~~
  |==|=====|=====|=====|=====|=====|=====|===&gt; Time
  |  O     O     O     O     O     O     O    ...
  |              |           |
  [ LV_A Active  [ Overlap   [ LV_B Active
 (1)            (2)         (3)

** 'X' marks the final advertisement for LV_A.
    Each 'O' at 'X' until and including 'Z' will
    include a VHA from the VB of LV_A.
** 'Z' marks the time at [X + LV_A.Expiration].
** 'O' indicates the advertisement of an LV on-link.

  Moments:
    1   = Link Voucher A is active for all nodes.
    2   = VHA. LOVMA-subscribed nodes become aware
           of a transition window. Both LV_A and
           LV_B are considered active LVs.
    3   = LV_A expires. Link Voucher B is active for
           neighbors and the transition completes.

</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-link-voucher-transitions-2" class="selfRef">Link Voucher Transitions</a>
          </figcaption></figure>
<p id="section-3.6-4">
          If another VHA appears indicating a third LV as appointed for election, receivers
          <span class="bcp14">MUST</span> ignore the VHA until one of the two LVs from the original VHA
          has expired. This prevents abuse which could flag several active LVs as being valid.
          Once the transition window ends, the amount of valid LVs <span class="bcp14">MUST</span> return
          from 2 to 1 before another transition can begin. The transition ends when the original
          voucher is intentionally not refreshed within its LV-specified Expiration time.<a href="#section-3.6-4" class="pilcrow">¶</a></p>
<p id="section-3.6-5">
          The voucher transition provides an opportunity for optimization: if neighbors are
          aware of the upcoming voucher, then they <span class="bcp14">MAY</span> preemptively generate new
          VBAs in anticipation of the completed transition.
          For neighbors that are not receiving LOVMA datagrams, the voucher transition process
          is more akin to a hard handoff. These interfaces will not trust the new voucher until
          the previous one has expired, at which time any voucher becomes acceptable. For this
          reason, any VBAs preemptively generated with the upcoming LV might not be successfully
          verified by neighbors unaware of the transition, until the window has ended and the
          new voucher becomes primary. All implementations <span class="bcp14">SHOULD</span> parse VHAs in
          order to secure the transition process.<a href="#section-3.6-5" class="pilcrow">¶</a></p>
<p id="section-3.6-6">
          If the current Voucher Bearer disconnects from the network or lets its voucher expire
          without an election, then the link becomes open and any neighbor can fill in the voucher
          void with its own. If no other VB assumes responsibility while the current VB is away or
          not transmitting updated vouchers, then all VBA-enabled interfaces <span class="bcp14">MUST</span>
          retain the most recent, valid voucher for the purposes of VBA generation and verification,
          until a new voucher becomes available.<a href="#section-3.6-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="behavioral-dad">
<section id="section-3.7">
        <h3 id="name-duplicate-address-detection">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-duplicate-address-detection" class="section-name selfRef">Duplicate Address Detection</a>
        </h3>
<p id="section-3.7-1">
          When generating a VBA, the node <span class="bcp14">MUST</span> follow the ordinary means of
          Duplicate Address Detection (DAD) specified by the SLAAC RFC (section 5.4 of
          <span>[<a href="#RFC4862" class="cite xref">RFC4862</a>]</span>). The DAD procedure <span class="bcp14">SHOULD</span> follow any other
          applicable DAD optimizations (<span>[<a href="#RFC4429" class="cite xref">RFC4429</a>]</span>, <span>[<a href="#RFC7527" class="cite xref">RFC7527</a>]</span>, etc.).<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<p id="section-3.7-2">
          Upon detecting a duplicate address during VBA generation, nodes <span class="bcp14">MUST</span>
          select another work factor 'L' value in order to create a non-conflicting address.
          Recomputing each new address for every collision can become computationally expensive,
          and can be abused in the case of denial-of-service attacks. To counter this weakness,
          implementations <span class="bcp14">MUST</span> employ one of two options based on the selected work factor:<a href="#section-3.7-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.7-3">
          <dt id="section-3.7-3.1"><code>L &gt;  4</code></dt>
          <dd style="margin-left: 1.5em" id="section-3.7-3.2">Cache the results of the 4 leading KDF iterations (L-4 through L-1).<a href="#section-3.7-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.7-3.3"><code>L &lt;= 4</code></dt>
          <dd style="margin-left: 1.5em" id="section-3.7-3.4">Cache the result of the KDF derived at the 'L' value only.<a href="#section-3.7-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.7-4">
          Implementations <span class="bcp14">SHOULD</span> always prefer the option where the work factor
          is greater than 4, because <code>L-4</code> through <code>L-1</code> produce intermediate KDF
          hashes that are already necessary in order to calculate the hash at the final 'L' value.
          Conversely, any 'L' value at or under 4 will cache the generated KDF hash at 'L' then
          increment the input 'L' by one for each DAD collision, up to 4 times.<a href="#section-3.7-4" class="pilcrow">¶</a></p>
<span id="name-using-dad-with-vbas"></span><figure id="figure-3">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-3.7-5.1">
<pre>

COMPUTE &amp; CACHE:
  N = Set of K(L', Key, Salt),
    where L' :=
      if L &gt; 4 :  { L-4, L-3, L-2, L-1, L },
      else     :  { L }

           (1)      +~~~~~~~~~~~~~~+
 |A|{B}------------&gt;| Normal SLAAC | (B :  Duplicate!)
  |     v-----------|  DAD Process | (B':  Success)
  |  [FAIL]  (2)    +~~~~~~~~~~~~~~+
  |                      ^
  `---&gt; [cached (L-1)    |
         or new (L+1)    | (3)
         generates B'] --'

</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-using-dad-with-vbas" class="selfRef">Using DAD with VBAs</a>
          </figcaption></figure>
<p id="section-3.7-6">
          In the figure, (1) shows node <code>A</code> engaged in DAD using the address <code>B</code>
          generated with <code>L</code>. After a collision is detected in (2), moment (3) shows the
          new VBA <code>B'</code> being immediately tried using the already-cached hash value from
          the work factor <code>L-1</code>. The DAD process is then successful and there are no
          duplicate addresses. The cost of computing <code>L-1</code> or some other input work factor
          has been avoided.<a href="#section-3.7-6" class="pilcrow">¶</a></p>
<p id="section-3.7-7">
          If all 5 attempted input work factors result in DAD collisions, then the node
          <span class="bcp14">MUST</span> give up and use some other course of action to either contact
          an administrator or log a system management error.<a href="#section-3.7-7" class="pilcrow">¶</a></p>
<p id="section-3.7-8">
          Protections to mitigate denial-of-service attacks based on DAD are beyond the scope of
          this document. However, the cost of the VBA generation procedure is safeguarded from being
          abused by DAD mechanisms or their misuses. Since VBAs do not modify the actual DAD process,
          other works regarding DAD denial of service protections will apply likewise when using VBAs.<a href="#section-3.7-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="addenda-voucher">
<section id="section-4">
      <h2 id="name-the-link-voucher-option">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-the-link-voucher-option" class="section-name selfRef">The Link Voucher Option</a>
      </h2>
<p id="section-4-1">
        The Link Voucher (LV) NDP option type describes the VBA generation and verification
        parameters which neighbors <span class="bcp14">MUST</span> use during the VBA-compliant SLAAC process.<a href="#section-4-1" class="pilcrow">¶</a></p>
<span id="name-structure-of-a-local-link-v"></span><figure id="figure-4">
        <div class="alignLeft art-ascii-art art-text artwork" id="section-4-2.1">
<pre>

   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type      |    Length     |           Expiration          |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  |                       Reserved (64 bits)                      |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  |                        64-bit Timestamp                       |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                        32-bit VoucherID                       |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  |                                                               |
  |                      128-bit Voucher Seed                     |
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  &gt;                       TLV Algorithm Type                      &lt;
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  &gt;                          DER-encoded                          &lt;
  &gt;                     PublicKey &amp; Signature                     &lt;
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  &gt;                            Padding                            &lt;
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-structure-of-a-local-link-v" class="selfRef">Structure of a local Link Voucher</a>
        </figcaption></figure>
<span class="break"></span><dl class="dlNewline" id="section-4-3">
        <dt id="section-4-3.1">Type</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.2">Link Voucher options are identified by Type ID 63<a href="#section-4-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.3">Length</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.4">The total length of the LV from the Type through its end, inclusive, in units of 8 octets.<a href="#section-4-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.5">Reserved</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.6">Denotes space reserved for future use. This value <span class="bcp14">MUST</span> be initialized to
          0 by senders and <span class="bcp14">MUST</span> be ignored by receivers.<a href="#section-4-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.7">Expiration</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.8">
          
          A 16-bit big-endian value storing the amount of time in seconds that the LV should be considered
          legitimate when an update has not been received. This value <span class="bcp14">SHOULD</span> be a minimum
          of 600 (10 minutes).<a href="#section-4-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.9">Timestamp</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.10">
          
          A 64-bit value representing the system time of the sender upon sending the option.<a href="#section-4-3.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.11">VoucherID</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.12">
          A pseudo-random 32-bit value which uniquely identifies an LV instance. This <span class="bcp14">MUST NOT</span> change between distributions of the same LV instance and seed value.<a href="#section-4-3.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.13">Seed</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.14">
          A 128-bit pseudo-random value used as an input in VBA generation. This value <span class="bcp14">MUST</span>
          be the same for each distribution of an LV instance identified by a VoucherID. It <span class="bcp14">MUST NOT</span> be the same value across different LV instances.<a href="#section-4-3.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.15">Algorithm Type</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.16">
          Specifies the type and difficulty of the KDF to use in VBA generation.
          See <a href="#addenda-voucher-kdfs" class="auto internal xref">Section 4.3</a> for more details.<a href="#section-4-3.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd><dt id="section-4-3.17">ECDSA PublicKey &amp; Signature</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.18">
          <p id="section-4-3.18.1">
            A variable-length field containing a DER-encoded ECDSA <span>[<a href="#ECDSA" class="cite xref">ECDSA</a>]</span> public key of
            type <code>SubjectPublicKeyInfo</code> according to Section 2 of <span>[<a href="#RFC5480" class="cite xref">RFC5480</a>]</span>.<a href="#section-4-3.18.1" class="pilcrow">¶</a></p>
<p id="section-4-3.18.2">
            The public key structure is followed immediately by an adjacent DER-encoded ECDSA signature,
            derived using the Private Key corresponding to PublicKey. The signature is computed over a
            series of sequential octets, constructed in the following order:<a href="#section-4-3.18.2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4-3.18.3">
            <li id="section-4-3.18.3.1">The 16-bit 'Expiration' value.<a href="#section-4-3.18.3.1" class="pilcrow">¶</a>
</li>
            <li id="section-4-3.18.3.2">The 64-bit 'Timestamp' value.<a href="#section-4-3.18.3.2" class="pilcrow">¶</a>
</li>
            <li id="section-4-3.18.3.3">The 32-bit 'VoucherID' value.<a href="#section-4-3.18.3.3" class="pilcrow">¶</a>
</li>
            <li id="section-4-3.18.3.4">The 128-bit 'Seed' value.<a href="#section-4-3.18.3.4" class="pilcrow">¶</a>
</li>
            <li id="section-4-3.18.3.5">The full variable-length contents of the 'Algorithm Type' field,
              including its Type and Length values.<a href="#section-4-3.18.3.5" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-4-3.18.4">
            The algorithm used in signature computation is ecdsa-with-SHA256, as defined in Section 3.2
            of <span>[<a href="#RFC5758" class="cite xref">RFC5758</a>]</span>. The Signature <span class="bcp14">MUST</span> be a DER-encoded <span>[<a href="#ITU.X690.2002" class="cite xref">ITU.X690.2002</a>]</span>
            ASN.1 structure of the type ECDSA-Sig-Value (Section 2.2.3 of <span>[<a href="#RFC3279" class="cite xref">RFC3279</a>]</span>).<a href="#section-4-3.18.4" class="pilcrow">¶</a></p>
<p id="section-4-3.18.5">
            The final field appears as the following two immediately adjacent DER structures:<a href="#section-4-3.18.5" class="pilcrow">¶</a></p>
<figure id="figure-5">
            <div class="alignLeft art-ascii-art art-text artwork" id="section-4-3.18.6.1">
<pre>

SubjectPublicKeyInfo  ::=  SEQUENCE  {
  algorithm         ::=  SEQUENCE {
    algorithm   OBJECT IDENTIFIER,
    parameters  ANY DEFINED BY algorithm OPTIONAL
  },
  subjectPublicKey  BIT STRING
}
ECDSA-Sig-Value  ::=  SEQUENCE  {
  r  INTEGER,
  s  INTEGER
}

</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a></figcaption></figure>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.19">Padding</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.20">
          Any extra padding added to the structure in order to round its total length to an even
          8-octet boundary. Senders <span class="bcp14">MUST</span> initialize this value to 0. Receivers
          <span class="bcp14">MUST</span> ignore this field.<a href="#section-4-3.20" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<div id="addenda-voucher-senders">
<section id="section-4.1">
        <h3 id="name-processing-rules-for-sender">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-processing-rules-for-sender" class="section-name selfRef">Processing Rules for Senders</a>
        </h3>
<p id="section-4.1-1">
          Current Voucher Bearers <span class="bcp14">MUST</span> always respond to Router Soliciation messages
          with the most current LV instance. Nodes wishing to be VBs <span class="bcp14">MUST</span> always
          follow a sequence of steps before transmitting:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.1-2">
          <li id="section-4.1-2.1">Send a Router Soliciation to the All Routers multicast group at <code>FF02::2</code>.<a href="#section-4.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.2">Wait for an existing voucher for at least 2 seconds before sending another RS.<a href="#section-4.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">Repeat this process 2 more times.<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-2.3.2.1">
                If an LV is received within an RA or Redirect response, accept and use the
                parameters of the received LV. This condition means the Sender <span class="bcp14">MUST NOT</span>
                use or send its own vouchers, nor should it propagate any instances of received vouchers.<a href="#section-4.1-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1-2.3.2.2">
                <p id="section-4.1-2.3.2.2.1">If no LV is received after the 3 total attempts, and...<a href="#section-4.1-2.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1-2.3.2.2.2.1">the Sender IS NOT a router: the Sender's LV option will be distributed on the local
                    link as an option attached to an appropriate NDP Redirect message.<a href="#section-4.1-2.3.2.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-4.1-2.3.2.2.2.2">the Sender IS a router: the Sender will attach its LV option to an appropriate
                    NDP RA message.<a href="#section-4.1-2.3.2.2.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
</li>
        </ol>
<p id="section-4.1-3">
          A change of any "stable" voucher information -- i.e., the VoucherID, Seed value, or Algorithm
          Type details -- <span class="bcp14">MUST</span> be signaled in advance using the voucher transition process,
          per <a href="#summary-interfaces-transitions" class="auto internal xref">Section 3.6</a>. Expiration values <span class="bcp14">MUST</span> be
          set to an appropriate value. Senders <span class="bcp14">MAY</span> adjust this value without requiring a
          transition.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">
          The Sender's LV option <span class="bcp14">MUST</span> always be unique and <span class="bcp14">MUST NOT</span> be a
          forwarded or duplicated copy of another LV. Additionally, the voucher's Seed value <span class="bcp14">MUST NOT</span> be preserved between different VoucherIDs or handoffs. It <span class="bcp14">MUST</span>
          always be a random value when first associated with an LV VoucherID.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="addenda-voucher-receivers">
<section id="section-4.2">
        <h3 id="name-processing-rules-for-receiv">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-processing-rules-for-receiv" class="section-name selfRef">Processing Rules for Receivers</a>
        </h3>
<p id="section-4.2-1">
          An LV option appearing with any message except NDP Router Advertisements or Redirects
          <span class="bcp14">MUST</span> be discarded and ignored. Nodes acting as authorized VBs <span class="bcp14">MUST</span>
          disregard any received LV options on the links for which they are already the active VB.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">
          Receivers <span class="bcp14">MUST NOT</span> accept vouchers which contain any other public key details
          or signatures which do not use the same public key as the current VB. Received vouchers which
          contain different VBA generation parameters (VoucherID, Seed, Algorithm Type details)
          <span class="bcp14">MUST</span> be ignored and <span class="bcp14">MUST NOT</span> update any stored voucher state,
          even if the LV signature is valid. Likewise, expired vouchers <span class="bcp14">MUST</span> be ignored.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">
          Vouchers with invalid timestamp values <span class="bcp14">MUST</span> be ignored. Timestamps
          <span class="bcp14">MUST</span> be considered invalid if the value falls outside of the range
          <code>[CURRENT_TIMESTAMP - LV_Expiration]</code> to <code>[CURRENT_TIMESTAMP + LV_Expiration]</code>,
          where <code>CURRENT_TIMESTAMP</code> is the precise 64-bit system time measured by the Receiver.
          In cases where the precise system time is measured in sub-second intervals like microseconds,
          the unit of 'seconds' in the <code>LV_Expiration</code> time still applies and <span class="bcp14">MUST</span>
          be converted properly for accurate arithmetic with <code>CURRENT_TIMESTAMP</code>. This
          timestamping process ensures that voucher validity remains flexible even with minor clock
          drifting between neighbors.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">
          When a Receiver is subscribed to the LOVMA and is notified of a new voucher transition (by
          receipt of a valid VHA), it <span class="bcp14">MUST</span> ignore further LV options with the previous
          LV's VoucherID. This ensures the VB follows through with its commitment to expire the previous
          LV once the transition began.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="addenda-voucher-kdfs">
<section id="section-4.3">
        <h3 id="name-the-algorithm-type-field">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-the-algorithm-type-field" class="section-name selfRef">The Algorithm Type Field</a>
        </h3>
<p id="section-4.3-1">
          This section specifies the default algorithms and KDF types that <span class="bcp14">MUST</span> be
          packaged with all VBA implementations. Future versions or extensions of this document
          <span class="bcp14">MAY</span> add new KDF algorithms corresponding and Type IDs. Any Algorithm Type
          option not specified in this document or in future versions <span class="bcp14">MUST</span> be ignored
          by receivers.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">
          An Algorithm Type choice is formatted as a Type-Length-Value (TLV) object, where Type is a
          numeric identifier uniquely representing a KDF, Length is the width of the total Algorithm
          Type in units of 4 octets, and Value is a compact data format zero-padded to the nearest
          32-bit (4-octet) boundary. Receivers <span class="bcp14">MUST</span> always ignore padding and Senders
          <span class="bcp14">MUST</span> always initialize padded areas to 0.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<span id="name-structure-of-an-algorithm-t"></span><figure id="figure-6">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-4.3-3.1">
<pre>

   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |              Type             |             Length            |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  &gt;                             Value                             &lt;
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-structure-of-an-algorithm-t" class="selfRef">Structure of an Algorithm Type Option</a>
          </figcaption></figure>
<p id="section-4.3-4">
          The list of default KDF Algorithm Type Types and their associated parameters is given below. All
          fields named "Padding" <span class="bcp14">MUST</span> be initialized to 0 by senders and <span class="bcp14">MUST</span>
          be ignored by receivers.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.3-5">
          <dt id="section-4.3-5.1">PBKDF2_SHA256</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-5.2">
            <p id="section-4.3-5.2.1">
              The Password-Based Key Derivation Function (PBKDF2) is defined in Section 5.2 of <span>[<a href="#RFC8018" class="cite xref">RFC8018</a>]</span>.
              It is a CPU-bound KDF, use of which can result in significant computation speed disparities
              across varying degrees of system resources. It is included primarily for portability,
              universality, and ease of implementation. This document explicitly uses PBKDF2 with SHA-256.
              Implementations using this Type <span class="bcp14">MUST</span> use SHA-256 as the underlying PBKDF2
              pseudo-random function.<a href="#section-4.3-5.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlNewline" id="section-4.3-5.2.2">
              <dt id="section-4.3-5.2.2.1">Type</dt>
              <dd style="margin-left: 1.5em" id="section-4.3-5.2.2.2">1<a href="#section-4.3-5.2.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.3-5.2.2.3">Length</dt>
              <dd style="margin-left: 1.5em" id="section-4.3-5.2.2.4">2<a href="#section-4.3-5.2.2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.3-5.2.2.5">Value</dt>
              <dd style="margin-left: 1.5em" id="section-4.3-5.2.2.6">
                <span class="break"></span><dl class="dlCompact dlNewline" id="section-4.3-5.2.2.6.1">
                  <dt id="section-4.3-5.2.2.6.1.1">ITERATIONS_FACTOR</dt>
                  <dd style="margin-left: 1.5em" id="section-4.3-5.2.2.6.1.2">
                    A big-endian, 16-bit, unsigned integer as the multiplier of the selected work factor 'L'.
                    This value <span class="bcp14">MUST</span> be greater than 0; receivers of 0 values <span class="bcp14">MUST</span>
                    assume 1 instead.<a href="#section-4.3-5.2.2.6.1.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-4.3-5.2.2.6.1.3">Padding (16 bits)</dt>
                  <dd style="margin-left: 1.5em" id="section-4.3-5.2.2.6.1.4"></dd>
                <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-5.3">Argon2d</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-5.4">
            <p id="section-4.3-5.4.1">
              The Argon2 algorithm is specified in Section 3 of <span>[<a href="#RFC9106" class="cite xref">RFC9106</a>]</span>. It is a Memory-bound
              KDF which will ideally provide less disparate address computation speeds than CPU-bound algorithms
              like PBKDF2. Note that VBA explicitly opts to use Argon2d, rather than Argon2i or Argon2id.
              The work factor 'L' value is used as the 't' input for Argon2d computations. The Argon2 't' parameter
              indicates the number of passes and is used to increase the algorithm's running time regardless of
              MemorySize. To give the LV parameters in the Value field more weight, 't' <span class="bcp14">MUST</span> always
              be reduced from the input 'L' value as follows:<a href="#section-4.3-5.4.1" class="pilcrow">¶</a></p>
<p id="section-4.3-5.4.2"><code>t := (L &gt;&gt; 8) + 1</code><a href="#section-4.3-5.4.2" class="pilcrow">¶</a></p>
<p id="section-4.3-5.4.3">
              The Argon2 parameters for Secret Value 'K' and Associated Data 'X' <span class="bcp14">MUST NOT</span> be used.
              The Tag Length 'T' for Argon2d <span class="bcp14">MUST</span> be set to 32 and <span class="bcp14">MUST NOT</span> vary.<a href="#section-4.3-5.4.3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlNewline" id="section-4.3-5.4.4">
              <dt id="section-4.3-5.4.4.1">Type</dt>
              <dd style="margin-left: 1.5em" id="section-4.3-5.4.4.2">10<a href="#section-4.3-5.4.4.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.3-5.4.4.3">Length</dt>
              <dd style="margin-left: 1.5em" id="section-4.3-5.4.4.4">2<a href="#section-4.3-5.4.4.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.3-5.4.4.5">Value</dt>
              <dd style="margin-left: 1.5em" id="section-4.3-5.4.4.6">
                <span class="break"></span><dl class="dlCompact dlNewline" id="section-4.3-5.4.4.6.1">
                  <dt id="section-4.3-5.4.4.6.1.1">Parallelism</dt>
                  <dd style="margin-left: 1.5em" id="section-4.3-5.4.4.6.1.2">
                    An 8-bit, unsigned integer specifying how many degrees of parallelism (lanes) are allowed to
                    run during KDF computation. This value <span class="bcp14">SHALL NOT</span> be set to 0. Receivers
                    <span class="bcp14">MUST</span> consider values of 0 to automatically indicate a value of 1.<a href="#section-4.3-5.4.4.6.1.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-4.3-5.4.4.6.1.3">MemorySize</dt>
                  <dd style="margin-left: 1.5em" id="section-4.3-5.4.4.6.1.4">
                    A big-endian, 24-bit, unsigned integer dictating the number of kibibytes (KiB) used in the KDF
                    computation. This value <span class="bcp14">MUST</span> be a minimum of <code>8 * Parallelism</code> and
                    <span class="bcp14">MUST NOT</span> be set to 0. Receivers <span class="bcp14">MUST</span> adjust the minimum MemorySize
                    accordingly if the value does not meet the minimum threshold for the specified Parallelism value.<a href="#section-4.3-5.4.4.6.1.4" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-5.5">Scrypt</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-5.6">
            <p id="section-4.3-5.6.1">
              The Scrypt KDF algorithm is specified in Section 6 of <span>[<a href="#RFC7914" class="cite xref">RFC7914</a>]</span>. It is also a
              Memory-bound KDF. The work factor 'L' value is used in parts of the 'N', 'r', and 'p' inputs for
              Scrypt computations, as opposed to being used more linearly. Input KDF parameters are set by the
              following conversions:<a href="#section-4.3-5.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-5.6.2.1">
                <code>N (Cost) := MAX(1 &lt;&lt; (MIN(11, MAX(1, ((L &amp; 0xFF00) &gt;&gt; 8) / 24))), 2) &lt;&lt; SCALING_FACTOR</code><a href="#section-4.3-5.6.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3-5.6.2.2">
                <code>p (Parallelization) := MAX( 1, (L &amp; 0x00F0) )</code><a href="#section-4.3-5.6.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3-5.6.2.3">
                <code>r (BlockSize) := MAX{ 1, (L &amp; 0x000F) )</code><br><a href="#section-4.3-5.6.2.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.3-5.6.3">
              The Scrypt parameter 'dkLen' (derived key length) <span class="bcp14">MUST</span> always be set to 32 and
              <span class="bcp14">MUST NOT</span> vary.<a href="#section-4.3-5.6.3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlNewline" id="section-4.3-5.6.4">
              <dt id="section-4.3-5.6.4.1">Type</dt>
              <dd style="margin-left: 1.5em" id="section-4.3-5.6.4.2">20<a href="#section-4.3-5.6.4.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.3-5.6.4.3">Length</dt>
              <dd style="margin-left: 1.5em" id="section-4.3-5.6.4.4">2<a href="#section-4.3-5.6.4.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.3-5.6.4.5">Value</dt>
              <dd style="margin-left: 1.5em" id="section-4.3-5.6.4.6">
                <span class="break"></span><dl class="dlCompact dlNewline" id="section-4.3-5.6.4.6.1">
                  <dt id="section-4.3-5.6.4.6.1.1">SCALING_FACTOR</dt>
                  <dd style="margin-left: 1.5em" id="section-4.3-5.6.4.6.1.2">
                    An 8-bit integer controlling the difficulty scaling of the Scrypt algorithm. This value
                    <span class="bcp14">MUST</span> only be 0 through 5 inclusive. Receivers <span class="bcp14">MUST</span> adjust
                    the maximum value to 5 if the received value is greater than 5.<a href="#section-4.3-5.6.4.6.1.2" class="pilcrow">¶</a>
</dd>
                  <dd class="break"></dd>
<dt id="section-4.3-5.6.4.6.1.3">Padding (24 bits)</dt>
                  <dd style="margin-left: 1.5em" id="section-4.3-5.6.4.6.1.4"></dd>
                <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="lovma">
<section id="section-5">
      <h2 id="name-local-on-link-voucher-multi">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-local-on-link-voucher-multi" class="section-name selfRef">Local On-link Voucher Multicast Address</a>
      </h2>
<p id="section-5-1">
        The LOVMA group is introduced to convey voucher-related updated between neighbors.
        All VBA-capable neighbors are strongly <span class="bcp14">RECOMMENDED</span> to join this group.
        However, current link VBs are always <span class="bcp14">REQUIRED</span> to join the LOVMA channel.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">
        This multicast group is located at the IP address <code>FF02::ABBA</code>. A helpful
        mnemonic to remember this address is to think of <code>ABBA</code> as a hexademical rendition
        of "a VBA".  The designated UDP port on which all LOVMA data is sent and received is <code>2196</code>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="lovma-constraints">
<section id="section-5.1">
        <h3 id="name-constraints">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-constraints" class="section-name selfRef">Constraints</a>
        </h3>
<p id="section-5.1-1">
          Nodes <span class="bcp14">MUST</span> regard these constraints when interacting with the LOVMA channel:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">LOVMA messages are considered unidirectional. Neighbors <span class="bcp14">MUST NOT</span> send
            unicast responses in reply to multicast traffic.<a href="#section-5.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.2">LOVMA messages <span class="bcp14">MUST</span> be User Datagram Protocol (UDP) <span>[<a href="#RFC768" class="cite xref">RFC768</a>]</span>
            datagrams.<a href="#section-5.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.3">Subscribing nodes <span class="bcp14">MUST NOT</span> assume that any other VBA-capable nodes
            are subscribed to the LOVMA group for any reason. However, neighbors <span class="bcp14">MAY</span>
            assume the presence of the current link VB on the LOVMA.<a href="#section-5.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.4">Subscribing nodes <span class="bcp14">MUST NOT</span> offer unconditional trust of LOVMA messages.
            Each message type may specify its own method of establishing trust for its recipients.<a href="#section-5.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.5">Senders are <span class="bcp14">REQUIRED</span> to send messages from a link-local VBA bound to the
            sending interface.<a href="#section-5.1-2.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="lovma-packets">
<section id="section-5.2">
        <h3 id="name-message-types">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-message-types" class="section-name selfRef">Message Types</a>
        </h3>
<p id="section-5.2-1">
          All LOVMA datagrams <span class="bcp14">MUST</span> use a Type-Length-Value (TLV) format. Type is an
          8-bit integer identifying the datagram type, Length is an 8-bit integer specifying the
          length of the packet (including the Type and Length fields) in units of 4 octets, and
          Value is the data to be handled.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
          The Type and Length fields <span class="bcp14">MUST NOT</span> be set to 0. Receivers <span class="bcp14">MUST</span>
          ignore datagrams with a Type of 0 or a Length of 0.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<span id="name-structure-of-lovma-datagram"></span><figure id="figure-7">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-5.2-3.1">
<pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Type     |     Length    |             Value             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+              ...              |
&gt;                              ...                              &lt;
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-structure-of-lovma-datagram" class="selfRef">Structure of LOVMA Datagrams</a>
          </figcaption></figure>
<div id="lovma-packets-vci">
<section id="section-5.2.1">
          <h4 id="name-voucher-capability-indicati">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-voucher-capability-indicati" class="section-name selfRef">Voucher Capability Indications (VCIs)</a>
          </h4>
<p id="section-5.2.1-1">
            A node <span class="bcp14">MAY</span> notify the LOVMA channel about its potential candidacy
            as a Voucher Bearer by sending a VCI datagram. The VCI is an informational datagram
            <span class="bcp14">REQUIRED</span> for consideration of election by the current VB. An "election"
            means the VB will transfer ownership of the active LV to the candidate.
            Neighbors <span class="bcp14">MUST NOT</span> consider VCI packets as valid vouchers. The VB
            <span class="bcp14">MAY</span> maintain a state of unexpired VCI messages, especially when it
            intends to appoint a new neighbor as a successor VB. VBs <span class="bcp14">MUST NOT</span>
            elect a new VB without first receiving a VCI datagram indicating the Sender's readiness.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">
            Sending nodes <span class="bcp14">MUST NOT</span> assume that issuance of a VCI packet is a
            guaranteed appointment as the VB. The decision for election <span class="bcp14">MUST</span> be
            indicated by receipt of a signed VHA datagram from the VB, whose signature's public
            key matches that of the current, active LV.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<span id="name-structure-of-a-vci-datagram"></span><figure id="figure-8">
            <div class="alignLeft art-ascii-art art-text artwork" id="section-5.2.1-3.1">
<pre>

   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |      Type     |     Length    |                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
  |                            Reserved                           |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  &gt;                      Link Voucher Contents                    &lt;
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-structure-of-a-vci-datagram" class="selfRef">Structure of a VCI Datagram</a>
            </figcaption></figure>
<span class="break"></span><dl class="dlNewline" id="section-5.2.1-4">
            <dt id="section-5.2.1-4.1">Type</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-4.2">1<a href="#section-5.2.1-4.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-4.3">Length</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-4.4">Variable. The datagram length rounded up to the nearest 4 octets.<a href="#section-5.2.1-4.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-4.5">Reserved</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-4.6">Space reserved for future use.<a href="#section-5.2.1-4.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-4.7">Link Voucher Contents</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-4.8">
              The entirety of the candidate ND Link Voucher option to be attached to future RAs or
              Redirects. This <span class="bcp14">MUST</span> also include the LV's Type and Length fields.
              Validation of this field follows the same rules outlined by <a href="#addenda-voucher" class="auto internal xref">Section 4</a>.
              Receivers <span class="bcp14">MUST NOT</span> expect the signature or public key of the LV to be
              the same as that of the current LV. Receivers <span class="bcp14">MUST</span> ignore the entire datagram
              if validation of the embedded LV fails for any reason, including invalid cryptographic
              signatures, null IDs, et al.<a href="#section-5.2.1-4.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="lovma-packets-vha">
<section id="section-5.2.2">
          <h4 id="name-voucher-handoff-advertiseme">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-voucher-handoff-advertiseme" class="section-name selfRef">Voucher Handoff Advertisements (VHAs)</a>
          </h4>
<p id="section-5.2.2-1">
            The VB <span class="bcp14">MAY</span> elect a new VB using the VHA message. This communication
            notifies subscribing VBA-capable nodes of a upcoming change in the active LV and possibly
            the VB of the LV. Candidates from election <span class="bcp14">MUST</span> be gathered from either manual
            sources or from senders of recent VCI datagrams. If the signature on the VHA is valid,
            listening nodes <span class="bcp14">MUST</span> accept the start of the handoff process whereby both
            VoucherID fields become temporarily valid. If the message signature field is not verifiable
            using the current VB's public key, then receivers <span class="bcp14">MUST</span> ignore the datagram.
            If there is no current LV and a VHA is received, then it <span class="bcp14">MUST</span> be ignored.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">
            The transition window duration is based on the 'Expiration' value of the current VB's LV at
            the time the VHA is sent. VHA retransmission frequency is variable but is <span class="bcp14">RECOMMENDED</span>
            to follow the same frequency as the node's previous RA or Redirect issuances. VBs initiating a
            transition <span class="bcp14">MUST</span> send at least one VHA notification every 5 seconds for a minimum
            of 3 minutes.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3">
            When the elected node becomes aware of its upcoming appointment, it <span class="bcp14">MUST</span>
            begin sending RAs or Redirects with its LV attached. Sending these messages will always
            echo the receipt of a valid, unexpired VHA from the appointing VB. After 2 minutes,
            the new VB <span class="bcp14">MUST</span> consider LVs of the previous VB as invalid, and therefore
            <span class="bcp14">MUST NOT</span> trigger any more voucher advertisements driven by receipt of VHAs.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.2-4">
            VHAs <span class="bcp14">MUST</span> also be used to indicate a change in active voucher details by using
            the 'Refresh' bit. This indicates a transition between LV parameters from the same VB rather
            than a change of the responsible VB. Using the VHA for this purpose affords neighbors enough
            time to fully transition interface VBAs between varying voucher details, like in ordinary
            elections.<a href="#section-5.2.2-4" class="pilcrow">¶</a></p>
<span id="name-structure-of-a-vha-datagram"></span><figure id="figure-9">
            <div class="alignLeft art-ascii-art art-text artwork" id="section-5.2.2-5.1">
<pre>

   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |      Type     |     Length    |R|          Reserved           |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  |                        64-bit Timestamp                       |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                    32-bit Signer VoucherID                    |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                   32-bit Upcoming VoucherID                   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  &gt;                                                               &lt;
  &gt;                     DER-encoded Signature                     &lt;
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  &gt;                            Padding                            &lt;
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-structure-of-a-vha-datagram" class="selfRef">Structure of a VHA Datagram</a>
            </figcaption></figure>
<span class="break"></span><dl class="dlNewline" id="section-5.2.2-6">
            <dt id="section-5.2.2-6.1">Type</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-6.2">2<a href="#section-5.2.2-6.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-6.3">Length</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-6.4">Variable. The datagram length rounded up to the nearest 4 octets.<a href="#section-5.2.2-6.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-6.5">R (Refresh Bit)</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-6.6">
              A single bit. When set, it indicates that the transition is only an LV refresh and is not
              a change of the VB.<a href="#section-5.2.2-6.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-6.7">Reserved</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-6.8">15 bits of space reserved for future use.<a href="#section-5.2.2-6.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-6.9">Timestamp</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-6.10">
              <p id="section-5.2.2-6.10.1">The current precise system time encoded as a 64-bit value.<a href="#section-5.2.2-6.10.1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-6.10.2">
                Timestamps <span class="bcp14">MUST</span> be considered invalid if the value is outside the range
                <code>[CURRENT_TIMESTAMP - 120]</code> to <code>[CURRENT_TIMESTAMP + 120]</code>, where
                <code>CURRENT_TIMESTAMP</code> is the precise 64-bit system time measured by the receiving
                node and <code>120</code> is in units of seconds. If the <code>CURRENT_TIMESTAMP</code> is
                measured in sub-second units like microseconds, then the <code>120</code> value
                <span class="bcp14">MUST</span> be converted appropriately.<a href="#section-5.2.2-6.10.2" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-6.11">Signer VoucherID</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-6.12">
              The VoucherID of the VB's active LV. Nodes using this ID for their active LV
              <span class="bcp14">MUST</span> disregard any further advertised LVs with this value upon receiving a
              valid VHA datagram. A receiver <span class="bcp14">MUST</span> ignore this packet if the Signer VoucherID
              is not equal to that of the active LV.<a href="#section-5.2.2-6.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-6.13">Upcoming VoucherID</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-6.14">The VoucherID of the new LV which is being appointed.<a href="#section-5.2.2-6.14" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-6.15">ECDSA Signature</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-6.16">
              <p id="section-5.2.2-6.16.1">
                A variable-length field containing a DER-encoded ECDSA <span>[<a href="#ECDSA" class="cite xref">ECDSA</a>]</span> signature,
                derived using the private key of the VB corresponding to the Signer VoucherID. The value
                of the public key is implied and expected to be known by receivers. The signature is
                computed over a series of sequential octets constructed in the following order:<a href="#section-5.2.2-6.16.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-5.2.2-6.16.2">
                <li id="section-5.2.2-6.16.2.1">The 64-bit 'Timestamp' value.<a href="#section-5.2.2-6.16.2.1" class="pilcrow">¶</a>
</li>
                <li id="section-5.2.2-6.16.2.2">The 32-bit 'Signer VoucherID' value.<a href="#section-5.2.2-6.16.2.2" class="pilcrow">¶</a>
</li>
                <li id="section-5.2.2-6.16.2.3">The 32-bit 'Upcoming VoucherID' value.<a href="#section-5.2.2-6.16.2.3" class="pilcrow">¶</a>
</li>
              </ol>
<p id="section-5.2.2-6.16.3">
                The algorithm used in signature computation is ecdsa-with-SHA256, as defined in Section 3.2
                of <span>[<a href="#RFC5758" class="cite xref">RFC5758</a>]</span>. This field <span class="bcp14">MUST</span> be a DER-encoded
                <span>[<a href="#ITU.X690.2002" class="cite xref">ITU.X690.2002</a>]</span> ASN.1 structure of the type ECDSA-Sig-Value (Section 2.2.3 of
                <span>[<a href="#RFC3279" class="cite xref">RFC3279</a>]</span>).<a href="#section-5.2.2-6.16.3" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-6.17">Padding</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.2-6.18">Padding necessary to round the message size up to the nearest 4-octet boundary.<a href="#section-5.2.2-6.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">
        This section covers VBA security topics which may not have had adequate exploration
        in the rest of the document.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="summary-overview-collisions">
<section id="section-6.1">
        <h3 id="name-collision-resistance-time-m">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-collision-resistance-time-m" class="section-name selfRef">Collision Resistance &amp; Time-Memory Tradeoffs</a>
        </h3>
<p id="section-6.1-1">
          VBA generation only preserves 48 bits from a resultant hash. While a collision is
          unlikely, nodes treat this as they do the DAD process: even if it is unlikely, it
          is a possibility and must be handled appropriately. Potential hash collisions are
          a weakness of VBA verification because LLID binding is done through a deterministic
          hashing process and nothing else. In other words, any other spoofable LLID producing
          the same 48-bit 'H' portion of the VBA suffix will result in an equally valid VBA
          according to the verification procedure.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">
          KDFs are used for VBA generation for the added purpose of slowing collision discoveries.
          The tradeoff of requiring slightly more time for address computation in order to protect
          against brute-force collision enumeration is a strategy also recommended for use in
          password storage systems to protect user secrets (see <span>[<a href="#SP.800-132" class="cite xref">SP.800-132</a>]</span>).
          To prevent any possible time-memory tradeoff attacks, the voucher is rotated semi-regularly
          to maintain an ever-moving 128-bit salt value, so VBAs can never be pared down to a simple
          dictionary attack.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">
          An attacker searching for inputs that produce a colliding address is therefore subjected
          to the misery of enumerating many different LLIDs in order to generate a VBA that matches
          the target's 48-bit hash suffix. This resultant VBA must also embed the same work factor
          as its target because it is an explicit part of the VBA itself. If the target IP address
          contains a high work factor value, then this brute-force process will be even slower and
          more unlikely to succeed. All the while, collision-producing inputs must be obtained before
          the rotation of the curremt voucher, which will reset the attacker's marathon entirely.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">
          For example, 1-millisecond VBA generation times for the most resource-rich neighbors equates
          to attempting only 1,000 spoofed LLIDs per second (3,600,000 LLIDs per hour). If the LLID in
          this case were an IEEE 802 MAC address, then 3.6M attempted MAC addresses is equivalent to
          only about a millionth of a percent of all possible addresses (2<sup>48</sup> when not
          accounting for reserved MAC address ranges). At the same time, a 1-millisecond delay to
          verify the LLID as a legitimate binding to a given VBA is a very negligible amount of time.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-ra-guard">
<section id="section-6.2">
        <h3 id="name-employing-ra-guard">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-employing-ra-guard" class="section-name selfRef">Employing RA-Guard</a>
        </h3>
<p id="section-6.2-1">
          RA-Guard is an important addition to the voucher distribution system. An excerpt from
          the RA-Guard RFC is noted:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<blockquote id="section-6.2-2">
          <span>[<a href="#RFC6105" class="cite xref">RFC6105</a>]</span> describes a solution framework for
          the rogue-RA problem <span>[<a href="#RFC6104" class="cite xref">RFC6104</a>]</span> where network segments are designed
          around a single L2-switching device or a set of L2-switching devices
          capable of identifying invalid RAs and blocking them.<a href="#section-6.2-2" class="pilcrow">¶</a>
</blockquote>
<p id="section-6.2-3">
          Use of RA-Guard is primarily suggested for networks with a more adversarial security posture.
          The RA-Guard system <span class="bcp14">SHOULD</span> be augmented and deployed with VBA awareness,
          capable of tracking the state of LVs and LOVMA messages. This will allow an intermediate
          network device to only require RA-Guard Learning Mode for a short initial period. It can
          then subsequently "follow" the authorized LV around the link, blocking any other malicious
          or spurious LV option transmissions that do not make sense. This would mean the system
          should monitor all Router Advertisement and Redirect NDP messages and their attached
          options.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">
          One notable exception to this, however, is that an RA-Guard implementation <span class="bcp14">MAY</span>
          drop its protections if and only if the most recent and legitimate LV has expired without
          a successor. This is because some responsible VB needs to be free to supersede an expired LV.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-usurp">
<section id="section-6.3">
        <h3 id="name-hijacking-or-desynchronizin">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-hijacking-or-desynchronizin" class="section-name selfRef">Hijacking or Desynchronizing Link Vouchers</a>
        </h3>
<p id="section-6.3-1">
          Hijacking the VB role can be achieved by a few different means. Without RA-Guard, false VBs
          are free to constantly advertise their own vouchers onto the network. For neighbors already
          having an active voucher, this is only a problem if VHAs in the LOVMA are not being used and
          the current LV expires. For neighbors joining the network for the first time, there is a
          timing opportunity for attackers to "lock them in" before the legitimate VB can advertise.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">
          If a legitimate VB goes offline and is not able to transmit any updated vouchers to the network,
          then its current voucher can expire. When a voucher expires, VBA requires nodes to acquire the
          next available voucher. If a malicious neighbor uses denial-of-service attacks to force a VB
          offline for long enough, then it can force an expiration of the current voucher and gain control
          of it.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">
          There are numerous threat vectors available to wannabe malicious VBs:<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-4.1">
            Denial of service attacks could result from setting LV parameters to an excessive difficulty.
            By asking local nodes to verify and generate VBAs according to absurd KDF options, ridiculous
            amounts of computing resources could be consumed and wasted. This could potentially consume
            enough resources on targets to temporarily force them offline.<a href="#section-6.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-4.2">
            Having multiple vouchers on the same link will inevitably lead to different logical subnetworks,
            where nodes using one voucher are generating and verifying addresses according to a different
            set of parameters than another. If verifications are being used to verify neighbor identities,
            then this could potentially stop communications between neighbors entirely.<a href="#section-6.3-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-4.3">
            If the difficulty of address generation is set to its absolute minimum, then bindings are
            cheapened for neighbors that use low work factor values because collisions would become easy
            to calculate.<a href="#section-6.3-4.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="security-dos-overrotate">
<section id="section-6.4">
        <h3 id="name-voucher-rotation-intervals">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-voucher-rotation-intervals" class="section-name selfRef">Voucher Rotation Intervals</a>
        </h3>
<p id="section-6.4-1">
          Short voucher Expiration values are disallowed in LV options because of possible time
          synchronization issues between neighbors and to prevent an 'address generation storm'. This
          mechanism intends to prevent malicious VBs from over-rotating the current voucher and
          exhausting resources of neighbors who will be very busy trying to keep up with address
          generation. Employing long 'Expiration' windows also allows the VB to "go away" or disconnect
          for a longer period of time without dropping the current voucher.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">
          Likewise, excessive durations for Expirations <span class="bcp14">SHOULD</span> be limited in more
          adversarial networks in order to prevent threat actors from discovering address collisions
          which they could use to make some VBA verifications useless. A happy medium will ensure a
          plentiful pool of addresses for each neighbor, while also not letting it get stagnant.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">
        This document defines a new Neighbor Discovery Protocol option type and one new link-local multicast
        address. The introduced Link Voucher option type contains another set of Type-Length-Value (TLV) packet options.
        The multicast address also uses other assigned TLV packets to convey important (but optional) protocol
        information.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">
        One new Neighbor Discovery Protocol option is defined in this document and must have a new Option Type
        value assigned in the "IPv6 Neighbor Discovery Option Formats" subregistry of the "Internet Control
        Message Protocol version 6 (ICMPv6) Parameters" registry.<a href="#section-7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-3.1">The Link Voucher option (63), described in <a href="#addenda-voucher" class="auto internal xref">Section 4</a>.<a href="#section-7-3.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-4">
        The Link Voucher option includes a new option type used to convey KDF algorithm selections.
        Assigned in the "Algorithm Type Options" subregistry are string identifiers corresponding to integers
        which indicate their Algorithm Type values. Future values <span class="bcp14">MUST</span> be assigned according to the
        Standards Action policy of <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Default registrations are defined in this document:<a href="#section-7-4" class="pilcrow">¶</a></p>
<span id="name-initial-values-of-the-algor"></span><div id="IANA-algo-type-registrations">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-initial-values-of-the-algor" class="selfRef">Initial Values of the "Algorithm Type Options" Subregistry</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Type</th>
            <th class="text-left" rowspan="1" colspan="1">Name/Identifier</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">VBAKDF_PBKDF2_SHA256</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">10</td>
            <td class="text-left" rowspan="1" colspan="1">VBAKDF_ARGON2D</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">20</td>
            <td class="text-left" rowspan="1" colspan="1">VBAKDF_SCRYPT</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-7-6">
        See <a href="#lovma" class="auto internal xref">Section 5</a> for information about the Local On-link Voucher Multicast
        Address subscribed to by VBA-enabled network interfaces. This section will also contain
        specific packet formats.<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">
        Assigned in the "Link-Local Scope Multicast Addresses" subregistry of the "IPv6 Multicast
        Address Space Registry":<a href="#section-7-7" class="pilcrow">¶</a></p>
<blockquote id="section-7-8">
        Address(es): FF02::ABBA<br>
        Description: Local On-link Voucher Multicast Address<br>
        Reference: draft-puhl-6man-vba-00<a href="#section-7-8" class="pilcrow">¶</a>
</blockquote>
<p id="section-7-9">
        The well-known UDP port 2196 is used for multicast traffic on the LOVMA channel. Assigned
        in the "Service Name and Transport Protocol Port Number Registry":<a href="#section-7-9" class="pilcrow">¶</a></p>
<blockquote id="section-7-10">
        Service Name: vba_lovma<br>
        Port Number: 2196<br>
        Transport Protocol: UDP<br>
        Description: IPv6 Voucher-Based Addressing multicast updates<br>
        Reference: draft-puhl-6man-vba-00<a href="#section-7-10" class="pilcrow">¶</a>
</blockquote>
<p id="section-7-11">
        A set of three TLV packet types used specifically in the new LOVMA channel are defined in
        this document. Assigned in the "LOVMA Message Types and Options" subregistry of the
        "Voucher-Based Addressing (VBA) Parameters" registry.<a href="#section-7-11" class="pilcrow">¶</a></p>
<p id="section-7-12">
        The values in the "LOVMA Message Types and Options" subregistry are string identifiers
        corresponding to integers which indicate their packet Type values. Future values
        <span class="bcp14">MUST</span> be assigned according to the Standards Action policy of
        <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Default registrations are defined in this document:<a href="#section-7-12" class="pilcrow">¶</a></p>
<span id="name-initial-values-of-the-lovma"></span><div id="IANA-lovma-registrations">
<table class="center" id="table-2">
        <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-initial-values-of-the-lovma" class="selfRef">Initial Values of the "LOVMA Message Types and Options" Subregistry</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Type</th>
            <th class="text-left" rowspan="1" colspan="1">Name/Identifier</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">LOVMA_VCI</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#lovma-packets-vci" class="auto internal xref">Section 5.2.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">LOVMA_VHA</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#lovma-packets-vha" class="auto internal xref">Section 5.2.2</a>
</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="future">
<section id="section-8">
      <h2 id="name-future-work">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-future-work" class="section-name selfRef">Future Work</a>
      </h2>
<p id="section-8-1">
        This section provides an overview of related topics that might be explored in future work.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="future-dhcp">
<section id="section-8.1">
        <h3 id="name-deployments-using-dhcp">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-deployments-using-dhcp" class="section-name selfRef">Deployments using DHCP</a>
        </h3>
<p id="section-8.1-1">
          Future work might wish to add features into DHCP servers that support delegating VBAs by
          using something like DHCP Snooping to ensure that only legitimate servers are assigning
          addresses. Because of its centrality and responsibility, a DHCP server would also be
          well-suited as the VB, especially if no connected router supports VBA.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">
          One notable change of generating VBAs server-side is the removal of client-side work factor
          selections. Allowing nodes to choose their own work factor values affords them
          the ability to randomize it according to their whims or retain a preferred work factor
          value. In a future proposal, DHCP client options could be amended to allow clients to
          request a work factor value, along with providing other important details to the server.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="future-pki">
<section id="section-8.2">
        <h3 id="name-certifying-link-vouchers">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-certifying-link-vouchers" class="section-name selfRef">Certifying Link Vouchers</a>
        </h3>
<p id="section-8.2-1">
          Future additions to this document could investigate the feasibility of PKI and certificates for signatures
          appearing on LV messages. This could include amendments to the LV structure which would extend the
          fields to convey trust anchor or certification path information. While VBA generally seeks to avoid
          the complexities introduced by PKI, it is perhaps a necessity for first-contact trust wherever RA-Guard
          or similar protections cannot be used. This is still a very performant use of certification paths
          since the certificate details are only verified during LV parsing when initially received.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC4861">[RFC4861]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Simpson, W.</span>, and <span class="refAuthor">H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC4862">[RFC4862]</dt>
        <dd>
<span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dd class="break"></dd></dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC8018">[RFC8018]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #5: Password-Based Cryptography Specification Version 2.1"</span>, <span class="seriesInfo">RFC 8018</span>, <span class="seriesInfo">DOI 10.17487/RFC8018</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8018">https://www.rfc-editor.org/info/rfc8018</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC9106">[RFC9106]</dt>
        <dd>
<span class="refAuthor">Biryukov, A.</span>, <span class="refAuthor">Dinu, D.</span>, <span class="refAuthor">Khovratovich, D.</span>, and <span class="refAuthor">S. Josefsson</span>, <span class="refTitle">"Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications"</span>, <span class="seriesInfo">RFC 9106</span>, <span class="seriesInfo">DOI 10.17487/RFC9106</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9106">https://www.rfc-editor.org/info/rfc9106</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC7914">[RFC7914]</dt>
        <dd>
<span class="refAuthor">Percival, C.</span> and <span class="refAuthor">S. Josefsson</span>, <span class="refTitle">"The scrypt Password-Based Key Derivation Function"</span>, <span class="seriesInfo">RFC 7914</span>, <span class="seriesInfo">DOI 10.17487/RFC7914</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7914">https://www.rfc-editor.org/info/rfc7914</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC4291">[RFC4291]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"IP Version 6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 4291</span>, <span class="seriesInfo">DOI 10.17487/RFC4291</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4291">https://www.rfc-editor.org/info/rfc4291</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC7217">[RFC7217]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"A Method for Generating Semantically Opaque Interface Identifiers with IPv6 Stateless Address Autoconfiguration (SLAAC)"</span>, <span class="seriesInfo">RFC 7217</span>, <span class="seriesInfo">DOI 10.17487/RFC7217</span>, <time datetime="2014-04" class="refDate">April 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7217">https://www.rfc-editor.org/info/rfc7217</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC7721">[RFC7721]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Gont, F.</span>, and <span class="refAuthor">D. Thaler</span>, <span class="refTitle">"Security and Privacy Considerations for IPv6 Address Generation Mechanisms"</span>, <span class="seriesInfo">RFC 7721</span>, <span class="seriesInfo">DOI 10.17487/RFC7721</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7721">https://www.rfc-editor.org/info/rfc7721</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC8064">[RFC8064]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Thaler, D.</span>, and <span class="refAuthor">W. Liu</span>, <span class="refTitle">"Recommendation on Stable IPv6 Interface Identifiers"</span>, <span class="seriesInfo">RFC 8064</span>, <span class="seriesInfo">DOI 10.17487/RFC8064</span>, <time datetime="2017-02" class="refDate">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8064">https://www.rfc-editor.org/info/rfc8064</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC8981">[RFC8981]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Krishnan, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">R. Draves</span>, <span class="refTitle">"Temporary Address Extensions for Stateless Address Autoconfiguration in IPv6"</span>, <span class="seriesInfo">RFC 8981</span>, <span class="seriesInfo">DOI 10.17487/RFC8981</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8981">https://www.rfc-editor.org/info/rfc8981</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC6104">[RFC6104]</dt>
        <dd>
<span class="refAuthor">Chown, T.</span> and <span class="refAuthor">S. Venaas</span>, <span class="refTitle">"Rogue IPv6 Router Advertisement Problem Statement"</span>, <span class="seriesInfo">RFC 6104</span>, <span class="seriesInfo">DOI 10.17487/RFC6104</span>, <time datetime="2011-02" class="refDate">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6104">https://www.rfc-editor.org/info/rfc6104</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC6105">[RFC6105]</dt>
        <dd>
<span class="refAuthor">Levy-Abegnoli, E.</span>, <span class="refAuthor">Van de Velde, G.</span>, <span class="refAuthor">Popoviciu, C.</span>, and <span class="refAuthor">J. Mohacsi</span>, <span class="refTitle">"IPv6 Router Advertisement Guard"</span>, <span class="seriesInfo">RFC 6105</span>, <span class="seriesInfo">DOI 10.17487/RFC6105</span>, <time datetime="2011-02" class="refDate">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6105">https://www.rfc-editor.org/info/rfc6105</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC4429">[RFC4429]</dt>
        <dd>
<span class="refAuthor">Moore, N.</span>, <span class="refTitle">"Optimistic Duplicate Address Detection (DAD) for IPv6"</span>, <span class="seriesInfo">RFC 4429</span>, <span class="seriesInfo">DOI 10.17487/RFC4429</span>, <time datetime="2006-04" class="refDate">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4429">https://www.rfc-editor.org/info/rfc4429</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC7527">[RFC7527]</dt>
        <dd>
<span class="refAuthor">Asati, R.</span>, <span class="refAuthor">Singh, H.</span>, <span class="refAuthor">Beebee, W.</span>, <span class="refAuthor">Pignataro, C.</span>, <span class="refAuthor">Dart, E.</span>, and <span class="refAuthor">W. George</span>, <span class="refTitle">"Enhanced Duplicate Address Detection"</span>, <span class="seriesInfo">RFC 7527</span>, <span class="seriesInfo">DOI 10.17487/RFC7527</span>, <time datetime="2015-04" class="refDate">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7527">https://www.rfc-editor.org/info/rfc7527</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC5758">[RFC5758]</dt>
        <dd>
<span class="refAuthor">Dang, Q.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Moriarty, K.</span>, <span class="refAuthor">Brown, D.</span>, and <span class="refAuthor">T. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure: Additional Algorithms and Identifiers for DSA and ECDSA"</span>, <span class="seriesInfo">RFC 5758</span>, <span class="seriesInfo">DOI 10.17487/RFC5758</span>, <time datetime="2010-01" class="refDate">January 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5758">https://www.rfc-editor.org/info/rfc5758</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC768">[RFC768]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time datetime="1980-08" class="refDate">August 1980</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc768">https://www.rfc-editor.org/info/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC3279">[RFC3279]</dt>
        <dd>
<span class="refAuthor">Bassham, L.</span>, <span class="refAuthor">Polk, W.</span>, and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 3279</span>, <span class="seriesInfo">DOI 10.17487/RFC3279</span>, <time datetime="2002-04" class="refDate">April 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3279">https://www.rfc-editor.org/info/rfc3279</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC5480">[RFC5480]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refAuthor">Brown, D.</span>, <span class="refAuthor">Yiu, K.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">T. Polk</span>, <span class="refTitle">"Elliptic Curve Cryptography Subject Public Key Information"</span>, <span class="seriesInfo">RFC 5480</span>, <span class="seriesInfo">DOI 10.17487/RFC5480</span>, <time datetime="2009-03" class="refDate">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5480">https://www.rfc-editor.org/info/rfc5480</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="ITU.X690.2002">[ITU.X690.2002]</dt>
        <dd>
<span class="refAuthor">International Telecommunications Union</span>, <span class="refTitle">"Information Technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER), and Distinguished Encoding Rules (DER)"</span>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.690">https://www.itu.int/rec/T-REC-X.690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ECDSA">[ECDSA]</dt>
        <dd>
<span class="refAuthor">Johnson, D.</span>, <span class="refAuthor">Menezes, A.</span>, and <span class="refAuthor">S. Vanstone</span>, <span class="refTitle">"The Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">DOI 10.1007/s102070100002</span>, <time datetime="2001-08" class="refDate">August 2001</time>, <span>&lt;<a href="https://doi.org/10.1007/s102070100002">https://doi.org/10.1007/s102070100002</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP.800-132">[SP.800-132]</dt>
      <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Recommendation for Password-Based Key Derviation, Part 1: Storage Applications"</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-132</span>, <time datetime="2010-12" class="refDate">December 2010</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-132">https://doi.org/10.6028/NIST.SP.800-132</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="appendix-code">
<section id="appendix-A">
      <h2 id="name-code-snippets">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-code-snippets" class="section-name selfRef">Code Snippets</a>
      </h2>
<p id="appendix-A-1">
        Source code demonstrating the VBA address generation and verification procedures,
        with assumed Neighbor Discovery Protocol support, can be found at
        https://github.com/NotsoanoNimus/voucher-based-addressing.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">
        The author would like to thank Dr. Jinhua Guo of the University of Michigan
        for his valuable, constructive feedback and support of this work.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Zack Puhl</span></div>
<div dir="auto" class="left"><span class="org">University of Michigan</span></div>
<div dir="auto" class="left">
<span class="locality">Detroit</span>, <span class="region">Michigan</span> </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:zpuhl@xmit.xyz" class="email">zpuhl@xmit.xyz</a>, <a href="mailto:zpuhl@umich.edu" class="email">zpuhl@umich.edu</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://xmit.xyz/" class="url">https://xmit.xyz/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jeremy Duncan</span></div>
<div dir="auto" class="left"><span class="org">Tachyon Dynamics</span></div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
