<?xml version="1.0" encoding="utf-8"?>
<!-- 
     draft-rfcxml-general-template-standard-00
  
     This template includes examples of the most commonly used features of RFCXML with comments 
     explaining how to customise them. This template can be quickly turned into an I-D by editing 
     the examples provided. Look for [REPLACE], [REPLACE/DELETE], [CHECK] and edit accordingly.
     Note - 'DELETE' means delete the element or attribute, not just the contents.
     
     Documentation is at https://authors.ietf.org/en/templates-and-schemas
-->
<?xml-model href="rfc7991bis.rnc"?>  <!-- Required for schema validation and schema-aware editing -->

<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>

<rfc
  xmlns:xi="http://www.w3.org/2001/XInclude"
  category="std"
  docName="draft-puhl-6man-ndp-vba-00"
  ipr="trust200902"
  obsoletes=""
  updates=""
  submissionType="IETF"
  xml:lang="en"
  version="3">
  <front>
    <title abbrev="ndp-vba">IPv6 Voucher-Based Address Generation &amp; verification</title>
    <seriesInfo name="Internet-Draft" value="draft-puhl-6man-ndp-vba-00"/>
    <author fullname="Zachary Tyler Puhl" initials="Z. T." surname="Puhl">
      <organization>University of Michigan</organization>
      <address>
        <postal>
          <city>Detroit</city>
          <country>US</country>
        </postal>
        <email>zpuhl@xmit.xyz</email>  
        <email>zpuhl@umich.edu</email>  
        <uri>https://xmit.xyz/</uri>
      </address>
    </author>
    <date year="2024"/>
    <area>Internet</area>
    <workgroup>IPv6 Maintenance</workgroup>
    <keyword>ipv6</keyword>
    <keyword>ndp</keyword>
    <keyword>vba</keyword>
    <keyword>spoofing</keyword>
    <keyword>privacy</keyword>
    <abstract>
      <t>
        This document specifies a new IPv6 unicast address generation and verification methodology for local
        networks. Individual interface identifiers are coupled to a set of deterministic output addresses, which
        remain outwardly private even if the interface identifier is stable. Distributed vouchers on-link are
        used to form a consensus between neighbors of the parameters used in the address derivation process.
        These vouchers are attached and distributed as an additional NDP option for Router Advertisements.
        Cryptographic key derivation functions are used to generate pseudo-random addresses and to also slow
        the computation of potential collisions. Voucher parameters are used to derive any number of both stable
        and ephemeral, privacy-focused addresses for each on-link prefix and at the link-local scope. NDP
        exchanges can then verify the interface-identifier-to-IP bindings to prevent on-path attacks in local
        networks.
      </t>
    </abstract>
  </front>


  <middle>
    <section anchor="intro">
      <name>Introduction</name>
      <t>
        This document introduces Voucher-Based Addressing (VBA) in IPv6 networks as an optional functionality for Neighbor Discovery Protocol (NDP) <xref target="RFC4861"/>.
      </t>
      
      <section anchor="intro-requirements">
        <name>Specification of Requirements</name>
        <t>
          The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
          "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT
          RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
          interpreted as described in BCP 14 <xref target="RFC2119"/>
          <xref target="RFC8174"/> when, and only when, they appear in
          all capitals, as shown here.
        </t>
      </section>

      <section anchor="intro-mod-summary">
        <name>Summary of NDP Modifications &amp; Requirements</name>
        <!-- special note in intro: this is LOW IMPACT!!! Only Vouchers & interface enablement (following behav. changes) are required for VBAs to work at the node level! -->
        <t>
        </t>
      </section>
    </section>

    <section anchor="terms">
      <name>Terms</name>
      <t>
      </t>
    </section>

    <section anchor="summary">
      <name>Voucher-Based Addressing Overview</name>
      <t>
      </t>

      <section anchor="summary-binding">
        <name>Link-Layer Bindings &amp; Controversies</name>
        <t>
        </t>
      </section>

      <section anchor="summary-generate">
        <name>Address Generation</name>
        <t>
        </t>
      </section>

      <section anchor="summary-verify">
        <name>Address Verification</name>
        <t>
        </t>
      </section>

      <section anchor="summary-interfaces">
        <name>Interface-level Configurations</name>
        <t>
        </t>

        <section anchor="summary-interfaces-state">
          <name>Preserving Voucher-Related State</name>
          <t>
          </t>
        </section>

        <section anchor="summary-interfaces-state">
          <name>Preserving Voucher-Related State</name>
          <t>
          </t>
        </section>

        <section anchor="summary-interfaces-mode">
          <name>Enforcement Modes</name>
          <t>
          </t>

          <section anchor="summary-interfaces-ago">
            <name>Address Generation Only (AGO)</name>
            <t>
            </t>
          </section>

          <section anchor="summary-interfaces-agv">
            <name>Address Generation &amp; Verification (AGV)</name>
            <t>
            </t>
          </section>

          <section anchor="summary-interfaces-agvl">
            <name>Address Generation &amp; Verification with Levels (AGVL)</name>
            <t>
            </t>
          </section>
        </section>
      </section>
    </section>

    <section anchor="addenda">
      <name>Neighbor Discovery Protocol Options</name>
      <t>
      </t>

      <section anchor="addenda-voucher">
        <name>RA Link Voucher Option</name>
        <t>
        </t>

        <section anchor="addenda-voucher-senders">
          <name>Processing Rules for Senders</name>
          <t>
          </t>
        </section>

        <section anchor="addenda-voucher-receivers">
          <name>Processing Rules for Receivers</name>
          <t>
          </t>
        </section>

        <section anchor="addenda-voucher-publickey">
          <name>Voucher Signatures &amp; Neighbor Trust</name>
          <t>
          </t>
        </section>

        <section anchor="addenda-voucher-expirations">
          <name>Voucher Expirations</name>
          <t>
          </t>
        </section>
      </section>

      <section anchor="addenda-voucher-summary">
        <name>ND Voucher Summary Option</name>
        <t>
        </t>

        <section anchor="addenda-voucher-senders">
          <name>Processing Rules for Senders</name>
          <t>
          </t>
        </section>

        <section anchor="addenda-voucher-receivers">
          <name>Processing Rules for Receivers</name>
          <t>
          </t>
        </section>
      </section>
    </section>

    <section anchor="behavioral">
      <name>Behavioral Neighbor Discovery Changes</name>
      <t>
      </t>

      <section anchor="behavioral-send">
        <name>Changes Adopted from Secure Neighbor Discovery</name>
        <t>
        </t>

        <section anchor="behavioral-send-nonce">
          <name>Nonce Option</name>
          <t>
          </t>
        </section>

        <section anchor="behavioral-send-levels">
          <!-- See Section 8 of RFC 3971. -->
          <name>Secured &amp; Unsecured Messages</name>
          <t>
          </t>
        </sections>
      </section>

      <section anchor="behavioral-cache">
        <name>Guarding the ND Cache</name>
        <t>
        </t>

        <section anchor="behavioral-cache-receiving">
          <name>Receiving Neighbor Solicitations</name>
          <t>
          </t>
        </section>

        <section anchor="behavioral-cache-unsolicited">
          <name>Receiving Unsolicited Traffic</name>
          <t>
          </t>
        </section>
      </section>

      <section anchor="behavioral-nud">
        <name>Neighbor Unreachability Detection</name>
        <t>
        </t>
      </section>

      <section anchor="behavioral-dad">
        <name>Duplicate Address Detection</name>
        <t>
        </t>
      </section>
    </section>

    <section anchor="lovma">
      <name>Local On-link Voucher Multicast Address (LOVMA)</name>
      <t>
      </t>

      <section anchor="lovma-purpose">
        <name>Definition &amp; Purpose</name>
        <t>
        </t>
      </section>

      <section anchor="lovma-purpose-constraints">
        <name>Constraints</name>
        <!-- no sending unicast responses, unidirectional channel; membership optional -->
        <t>
        </t>
      </section>

      <section anchor="lovma-packets">
        <name>Defined Datagrams</name>
        <t>
        </t>

        <section anchor="lovma-packets-vsr">
          <name>Voucher Status Reports (VSRs)</name>
          <t>
          </t>
        </section>

        <section anchor="lovma-packets-handoff">
          <name>Voucher Handoff Advertisements (VHAs)</name>
          <t>
          </t>
        </section>

        <section anchor="lovma-packets-pvr">
          <name>Preemptive Voucher Rotations (PVRs)</name>
          <t>
          </t>
        </section>
      </section>

      <section anchor="lovma-extensibility">
        <name>Extensibility &amp; Experimentation</name>
        <t>
        </t>
      </section>
    </section>

    <section anchor="bearers">
      <name>Voucher Bearers</name>
      <t>
      </t>

      <section anchor="bearers-vigilance">
        <name>Vigilance &amp; RA-Guard</name>
        <t>
        </t>
      </section>

      <section anchor="bearers-unorthodox">
        <name>Unorthodox Bearers</name>
        <t>
        </t>
      </section>
    </section>

    <section anchor="optimizations">
      <name>Protocol Optimizations</name>
      <t>
      </t>

      <section anchor="optimizations-dad">
        <name>Duplicate Address Detection Caching</name>
        <t>
        </t>
      </section>

      <section anchor="optimizations-lovma">
        <name>Conveying Voucher-Related Information via the LOVMA</name>
        <t>
        </t>
      </section>

      <section anchor="optimizations-kdfs-et-al">
        <name>Choosing Key Derivation Functions &amp; Parameters</name>
        <t>
        </t>
      </section>
    </section>

    <section anchor="transitions">
      <name>Transition Mechanisms</name>
      <t>
      </t>
    </section>
    
    <section>
      <name>Body [REPLACE]</name>
      <t>Body text [REPLACE]</t>
      
      <ol>
        <li>Ordered list item [REPLACE/DELETE]</li>
      </ol>
      
      <ul>
        <li>Bulleted list item [REPLACE/DELETE]</li>
      </ul>
      
      <dl newline="true">
        <!-- Omit newline="true" if you want each definition to start on the same line as the corresponding term -->
        <dt>First term: [REPLACE/DELETE]</dt>
        <dd>Definition of the first term [REPLACE/DELETE]</dd>
        <dt>Second term: [REPLACE/DELETE]</dt>
        <dd>Definition of the second term [REPLACE/DELETE]</dd>
      </dl>
      
      <table>
        <thead>
        <!-- [REPLACE/DELETE] a table header is optional -->
          <tr><th>Column 1 [REPLACE]</th></tr>
        </thead>
        <tbody>
          <tr><td>Cell [REPLACE]</td></tr>
        </tbody>
      </table>

      <figure>
        <name>Source [REPLACE]</name>
        <sourcecode name="suggested filename [REPLACE/DELETE]" type="language [REPLACE/DELETE]" markers="true">
          <![CDATA[
source code goes here [REPLACE]
          ]]>
        </sourcecode>
        <!-- [CHECK] markers="true" means that the rendered file will have <CODE BEGINS> and <CODE ENDS> added -->
      </figure>

      <figure>
        <name>Diagram [REPLACE]</name>
        <artset>
        <!-- This <artset> includes two <artwork> elements, each of a different type -->
          <artwork type="svg" src="https://www.rfc-editor.org/materials/format/svg/stream.svg" />
          <!-- [REPLACE] src points to either a local file or a URI. -->
          <artwork type="ascii-art" name="stream.txt">
            <!-- [REPLACE/DELETE] name recommends a filename to use if the diagram is extracted -->  
            <![CDATA[
 ascii-art diagram goes here [REPLACE]
            ]]>
          </artwork>
        </artset>
      </figure>
    </section>
    
    <section anchor="Security">
      <name>Security Considerations</name>
      <t>
      </t>

      <section anchor="security-binding">
        <!-- From SEND:
            SEND does not compensate for an unsecured link layer.  For instance,
            there is no assurance that payload packets actually come from the
            same peer against which the NDP was run.
            Likewise, VBAs rely on the principle that two link-layer addresses CANNOT share the same broadcast medium.
            VBAs offer great protection for unsecured L2 setups, but link-layer security would help to remediate further concerns.
        -->
        <name>Link-Layer Bindings</name>
        <t>
        </t>
      </section>

      <section anchor="security-solutions">
        <name>How VBAs Balance Privacy &amp; Security</name>
        <t>
        </t>

        <section anchor="security-solutions-proof">
          <name>Proof of Address Ownership</name>
          <t>
          </t>
        </section>

        <section anchor="security-solutions-privacy">
          <name>Private &amp; Ephemeral Addresses</name>
          <t>
          </t>
        </section>
      </section>

      <section anchor="security-usurp">
        <name>Hijacking Vouchers</name>
        <t>
        </t>
      </section>

      <section anchor="security-dos">
        <name>Denial of Service</name>
        <t>
        </t>
      </section>

      <section anchor="security-static">
        <name>Static Addressing</name>
        <t>
        </t>
      </section>

      <section anchor="security-collisions">
        <name>Hash Collisions</name>
        <t>
        </t>
      </section>

      <section anchor="security-fairness">
        <name>Computational Fairness</name>
        <t>
        </t>
      </section>
    </section>
    
    <section anchor="IANA">
      <name>IANA Considerations</name>
      <t>
      </t>
    </section>
  </middle>


  <back>
    <references>
      <name>References</name>
      <references>
        <name>Normative References</name>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3971.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.4861.xml"/>
      </references>
      <references>
        <name>Informative References</name>
        <!-- key-derivation crypto resources -->
      </references>
      <!-- <references>
        <name>Informative References</name>
        <reference anchor="exampleRefMin">
          <front>
            <title>Title [REPLACE]</title>
            <author initials="Initials [REPLACE]" surname="Surname [REPLACE]">
              <organization/>
            </author>
            <date year="2006"/>
          </front>
        </reference>
        <reference anchor="exampleRefOrg" target="http://www.example.com/">
          <front>
            <title>Title [REPLACE]</title>
            <author>
              <organization>Organization [REPLACE]</organization>
            </author>
            <date year="1984"/>
          </front>
        </reference>       
      </references> -->
    </references>
    
    <section anchor="appendices">
      <name>Appendices</name>

      <section anchor="appendices-a">
        <name>Appendix A</name>
        <t>
        </t>
      </section>
    </section>
 </back>
</rfc>
